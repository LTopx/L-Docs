import { Screenshot } from "components/screenshot";
import v0611 from "../public/change-log/v0.6.1-1.png";
import v0601 from "../public/change-log/v0.6.0-1.png";
import v0711 from "../public/change-log/v0.7.1-1.png";
import v0712 from "../public/change-log/v0.7.1-2.png";
import v0721 from "../public/change-log/v0.7.2-1.png";
import v0731 from "../public/change-log/v0.7.3-1.jpg";
import v0732 from "../public/change-log/v0.7.3-2.jpg";
import v0733 from "../public/change-log/v0.7.3-3.jpg";
import v0811 from "../public/change-log/v0.8.1-1.png";

# L-GPT 更新日志

## v0.8.1

> 2023-08-03

<Screenshot src={v0811} alt="Project link" full />

### 修复

- 修复重新生成对话出错时无法正常弹出错误信息的问题

### 新增

- 新增 AI 角色模板模板功能，内置部分常用模板
- AI 角色模板新增自定义功能，用户可以自定义模板使用
- 支持 url 传参的形式导入 prompt
- 新增 AI 角色模板的收藏功能
- 添加更多 AI 角色模板
- 新增 AI 角色模板的导入和导出功能
- 新增支持编辑聊天内容
- 会话内容操作按钮区域新增文字提示信息
- 新增项目 logo
- 新增 opengraph-image 和 twitter-image

### 调整

- 调整 gpt-tokens 计算模块，现在能够正确计算所有消耗的 token
- 调整注册策略，现在用户注册即送 10000 点数
- 优化 AI 角色模板弹窗界面的显示效果
- 配合官方文档，调整 zustand api
- 替换部分 Input 为 Textarea

## v0.8.0

> 2023-07-23

### 新增

- 新增引入 @ltopx/lx-ui 组件库，进一步统一全局风格样式

### 修复

- 修复不同模型下费用扣除不正确的问题（之前少扣了不少费用）

### 调整

- 移除 @vercel/analytics
- 移除 sentry
- 暂时移除 prompt market，下周末之前重构好上线
- 重构 zustand 状态相关的大部分逻辑，极大的减少 render 次数，提升整体性能

## v0.7.3

> 2023-07-04

<div className="flex gap-2">
  <Screenshot src={v0731} alt="Project link" full />
  <Screenshot src={v0733} alt="Project link" full />
</div>
<Screenshot src={v0732} alt="Project link" full />

### 修复

- 修复 Select 组件显示 bug

### 新增

- 新增支持 Azure 的 0613 和 0613-16K 模型
- 新增支持查看消耗的 token 详情
- 新增输入框顶部显示当前会话使用的语言模型
- 新增设置会话携带上下文数量的最大长度功能
- 输入框顶部新增”新建会话“快捷操作按钮
- 新增 Plausible Analytics 统计，替换 vercel analytics

### 调整

- 调整输入框顶部按钮布局
- 调整非会员最多只能创建 10 个会话（Premium）
- 升级 Azure api-version 为 2023-06-01-preview
- 优化会话列表头像图标，按照当前使用的语言模型显示

## v0.7.2

> 2023-06-30

<Screenshot src={v0721} alt="Project link" full />

### 修复

- 修复本地引入 azure tts 后，缺失 bufferutil 和 utf-8-validate 的 bug
- 修复在 service 端错误引用了 client 代码的问题
- 修复 azure tts 播放和暂停控制的 bug

### 新增

- 新建会话时，沿用用户之前选择的语言模型
- 添加初始化全局 loading
- Azure TTS 新增自动播放选项（Premium）

### 调整

- 重构滚动列表模块，优化性能
- 删减部分多余功能，提升性能
- 优化 UI 细节，统一全局图标样式。将 react-icons 替换为 MingCute Icon
- 优化 OpenAI/Azure 接口返回错误格式
- 升级 gpt-tokens 依赖

## v0.7.1

> 2023-06-28

<div className="flex gap-2">
  <Screenshot src={v0711} alt="Project link" full />
  <Screenshot src={v0712} alt="Project link" full />
</div>

### 新增

- 新增 vervel 全局变量 CRON_SECRET, 用于定时任务的安全校验
- 新增 Azure TTS 功能，支持将会话回复的内容转换为语音（Premium）

### 调整

- 优化初始获取用户信息的逻辑：未登录用户不拉取用户信息
- 完善 OpenAI 返回报错信息的展示
- 优化部分国际化内容
- 优化部分 UI 细节
- 优化发送会话消息逻辑代码，重构“重新生成”会话的逻辑

## v0.7.0

> 2023-06-21

### 修复

- 修复 polyfill 不生效的问题，确保其在 client 加载
- 修复高级版用户再免费试用时用户权限错误变更的问题

### 新增

- 新增 Premium 功能，支持作者后续研发
- 新增支持 Token 充值，解锁更多会话额度
- 新增激活许可证引导
- 新增 Token 不足时的引导：开始免费试用 or 充值 Token
- 新增 Free trial 和 Premium 的 token 赠送数额说明
- 新增定时任务每日核算 Token 消耗

### 调整

- 调整激活 license key 的位置到左侧菜单，更加醒目
- 优化 clipboard 使用

## v0.6.2

> 2023-06-16

### 修复

- 修复 Github 登录时点击取消返回页面显示有误的问题 [#2](https://github.com/Peek-A-Booo/L-GPT/issues/2)

### 新增

- 补全之前新增的所有模型（除 OpenAI-0301 模型外）

## v0.6.1

> 2023-06-14

<Screenshot src={v0611} alt="Project link" full />

### 修复

- 后端计算 token 修改为异步，不然会导致计算不准确
- 修复菜单置顶计算排序方式有误的问题

### 新增

- 新增后端计算 token 消耗的能力
- 新增菜单处显示当前消耗的总 token 数量
- 新增支持多会话同时对话，切换会话时不会断掉当前会话的链接
- 新增支持 openai 刚更新的模型： gpt-3.5-turbo-0613/gpt-3.5-turbo-16k

### 修改

- 优化前端计算 token 的逻辑，现在能够正确计算所有消耗的 token
- 大量代码和交互细节优化

## v0.6.0

> 2023-06-10

<Screenshot src={v0601} alt="Project link" full />

### 新增

- 新增 Prompt Market
- 新增首页还原 prompt 为默认的功能按钮

### 修复

- 修复移动端菜单新增会话时没有代入默认 prompt 的问题
- 修复首页 prompt 超长时的显示问题

### 修改

- 优化用户名缺失时的显示效果
- 其他大量细节优化
- 优化 prompt 和 Prompt Market 的 UI 细节

## v0.5.3

> 2023-06-06

### 新增

- 新增为客户端单独写的接口，目前只支持传递自己的 key 实现对话
- 为接口添加跨域支持，方便客户端进行跨域调用

### 修改

- 优化 UI 组件的实现

## v0.5.2

> 2023-06-03

### 修复

- 修复升级到 next 13.4.4 打包报错的问题
- 尝试修复 not-found 页面不生效的问题

### 新增

- 新增跳转到文档项目的各种引导链接

### 修改

- 继续优化接口请求错误提示。现在能够正确的看到会话文本超长的错误提示
- 优化登录验证时发送的邮件样式

## v0.5.1

> 2023-06-02

### 新增

- 添加清除 7 天之前无用的会话分享的定时服务
- 添加跳转 [L-GPT 文档链接](https://docs.ltopx.com/zh-CN)

### 修复

- 修复配置 API Key 页面在中文下和暗黑模式下的显示问题
- 添加 lang 解决生成预览图片乱码的问题

### 修改

- 调整分享的会话没有标题时的默认展示内容
- 合并 share api 路由

## v0.5.0

> 2023-05-30

### 新增

- 新增会话分享功能

### 修改

- 将 prisma 变量定义全部移动到.env.local
- 统一全局 Logo 样式
- 多处细节优化
- 优化更多极限情况下的 token 消耗计算逻辑

## v0.4.3

> 2023-05-28

### 修复

- 修复未登录用户配置 api key 依旧无法正常对话的问题
- 修复 Select placeholder 的文本颜色问题以及 disabled 的逻辑问题
- 修复路由跳转丢失 locale path 的问题。替换 next/navigation/useRouter 为 next-intl/client/useRouter

### 修改

- 优化登录界面 UI
- 优化加载用户信息时，用户头像处的显示效果
- 升级默认的 Azure OpenAI Service API Version 从 2023-03-15-preview 到 2023-05-15
- 重构会话消耗的计算逻辑，现在支持展示当前会话内容消耗以及当前会话总消耗
- 优化 Select/Input/Modal/Slider/Button 等组件 UI 效果
- 重构 API Key 配置界面，将其移动到单独的界面进行配置。现在能更友好的配置 Azure OpenAI Service 相关信息

## v0.4.2

> 2023-05-25

### 修复

- 修复 session 回调频繁查询数据库的 bug

### 新增

- 新增当前会话消耗的 Token 和 USD 展示
- 新增有关 Token 和会话上下文限制相关介绍
- 新增问题意见反馈渠道：support.qq.com
- 新增支持切换 Enter 和 Command+Enter (Mac)/Ctrl+Enter (Windows) 输入信息的方式
- 新增在左侧菜单顶部展示当前应用版本号
- 新增支持点击会话标题修改当前会话配置

### 修改

- 简化会话聊天内容“复制”和“删除”的 UI 和逻辑
- 调整登录有效期时长为 3 天
